\chapter{Sensores de peso}
\obj
Implementar un sistema de medición de peso utilizando el módulo HX711 con calibración multipunto, promediado de lecturas y menú interactivo por monitor serial.

\mat
\begin{itemize}
  \item Arduino Uno
  \item Módulo HX711
  \item Celda de carga de \SI{1}{\kilogram}
  \item Biblioteca \texttt{HX711\_MP} de Rob Tillaart
  \item Pesas de referencia (500g, 1000g, 1500g)
  \item Cable USB y computadora con Arduino IDE
\end{itemize}

\pro
\begin{enumerate}
  \item Conectar el HX711 a los pines digitales 2 (SCK) y 3 (DT) del Arduino.
  \item Cargar el código con menú interactivo.
  \item Abrir el monitor serial a 9600 baudios.
  \item Usar las siguientes teclas para interactuar:
  
    \begin{itemize}
      \item \texttt{r} → Registrar punto de calibración (ingresa el peso y presiona una tecla para capturar).
      \item \texttt{p} → Mostrar peso promedio (10 lecturas).
      \item \texttt{c} → Mostrar lectura cruda del HX711.
      \item \texttt{t} → Aplicar tara.
      \item \texttt{l} → Listar puntos de calibración registrados.
    \end{itemize}
    
  \item Registrar al menos tres puntos de calibración. Para ello,  escriba el comando \texttt{r} cuando el menú aparece, luego ingresar el peso en gramos y presiona cualquier tecla cuando el peso esté colocado.

  \item Puedes repetir este proceso para los otros puntos de calibración.
  
  \item Usa \texttt{p} para verificar la estabilidad de las lecturas.
  
  \item Usa \texttt{l} para revisar los puntos registrados. Puede anotar o tomar fotografía de estos valores como referencia futura.
  

%%% Densidad del agua

\item Realizar el cálculo de la densidad de agua de la muestra brindada:

  \begin{enumerate}

    \item Utilizar una pequeña taza de medida (por ejemplo, de \SI{100}{\milli\liter}) como recipiente.
  
    \item Aplicar tara con la taza vacía sobre la celda de carga.
  
    \item Verter un volumen conocido de agua (por ejemplo, \SI{50}{\milli\liter}) utilizando un vaso medidor.
  
    \item Medir el peso del agua utilizando el menú interactivo (\texttt{p}).
  
    \item Calcular la densidad experimental del agua usando:
  
  \[
  \rho = \frac{m}{V}
  \]

  donde $m$ es la masa medida en gramos y $V$ el volumen en mililitros (convertido a cm\textsuperscript{3} si se desea en g/cm\textsuperscript{3}).
  
    \item Comparar el valor obtenido con la densidad teórica del agua a temperatura ambiente (\SI{1.00}{\gram\per\centi\meter\cubed}).

  \end{enumerate}

  \end{enumerate}



%%% Código de arduino

\section*{Código Arduino}
\lstinputlisting[language=Arduino,numbers=none]{../code/L04/L04.ino} 



\section*{Preguntas de análisis en clase}

\begin{enumerate}
  \item ¿Cuál es la principal ventaja de utilizar calibración multipunto con el HX711?
  \begin{itemize}
    \item[a)] Mejora la precisión al interpolar entre varios puntos de referencia.
    \item[b)] Evita el uso de resistencias externas.
    \item[c)] Reduce el ruido eléctrico del sistema.
    \item[d)] Permite medir voltajes directamente.
  \end{itemize}

  \item ¿Qué función se utiliza para registrar un nuevo punto de calibración en la biblioteca HX711\_MP?
  \begin{itemize}
    \item[a)] \texttt{scale.addCalibratePoint()}
    \item[b)] \texttt{scale.set\_scale()}
    \item[c)] \texttt{scale.tare()}
    \item[d)] \texttt{scale.getWeight()}
  \end{itemize}

  \item ¿Qué ocurre si se registran puntos de calibración con errores o valores inconsistentes?
  \begin{itemize}
    \item[a)] El sistema entra en modo de calibración forzada.
    \item[b)] El HX711 se reinicia por seguridad.
    \item[c)] El sistema ignora los puntos incorrectos automáticamente.
    \item[d)] La interpolación puede generar lecturas erróneas.
  \end{itemize}

  \item ¿Cuál es el propósito de aplicar una tara en el sistema de medición?
  \begin{itemize}
    \item[a)] Reducir el consumo de energía del HX711.
    \item[b)] Calibrar automáticamente todos los puntos.
    \item[c)] Establecer un punto de referencia cero antes de medir.
    \item[d)] Eliminar el peso de la celda de carga.
  \end{itemize}

  \item ¿Qué ventaja ofrece el uso de lecturas promediadas en el sistema?
  \begin{itemize}
    \item[a)] Reduce el consumo de memoria.
    \item[b)] Aumenta la velocidad de lectura.
    \item[c)] Permite calibrar sin pesas de referencia.
    \item[d)] Minimiza el ruido y mejora la estabilidad de la medición.
  \end{itemize}

\end{enumerate}



\section*{Preguntas de análisis para el informe}

\begin{enumerate}

  \item ¿Cuál es la resolución teórica del módulo HX711 si trabaja con un convertidor de 24 bits y una celda de carga de \SI{10}{\kilogram}? ¿Qué implicaciones tiene esto en la medición de masas pequeñas? Como recomendación, utilizar la siguiente ecuación:

  \[
  \text{Resolución} = \frac{Capacidad de la celda}{2^{Número de bits}}
  \]

  \item ¿Cómo afecta el ruido eléctrico a la estabilidad de las lecturas? ¿Qué estrategias se implementaron en el código para mitigar este efecto?

  \item ¿Qué diferencia hay entre una lectura cruda y una lectura calibrada? ¿Qué ocurre si se utiliza la lectura cruda para una medición?

  \item ¿Qué papel juega la tara en la reducción de errores sistemáticos? ¿En qué casos podría no ser suficiente?

  \item ¿Qué ventajas ofrece la interpolación multipunto frente a una calibración basada en regresión lineal global? ¿En qué casos convendría cada una?

  
\end{enumerate}
  
