\documentclass[aspectratio=169]{beamer}
\usetheme{Bruno}
\input{preamble}
\title{Electricidad I: \\ \emph{Respuesta completa: RC}}
\author{
    Juan J. Rojas
}
\institute{Instituto Tecnológico de Costa Rica}
\date{\today}
\background{fig/background.jpg}

\begin{document}
\input{postamble}
\maketitle

\begin{frame}{Circuito RC: respuesta a un escalón}
    \begin{columns}[onlytextwidth]
    \begin{column}{0.5\textwidth}
        \centering
        \only<1->{
            \begin{circuitikz}[scale=0.8]
            \draw
            (0,0)
                to [V, l=$v_f$]
            (0,4) 
                to [R, l=$R$]
            (4,4)
                to[C,l=$C$, v=$v$,voltage shift=3]
            (4,0) 
                to[short]
            (0,0)
            ;
            \draw<2-4> 
                (4,4)
                    to[open,i=$i_R$]
                (3,4)
                (4,4)
                    to[open,i=$i_C$]
                (4,3)
            ;
            \node [right] at (-1,-1) {$v_f(t)=V_0u(t_0-t)+Vu(t-t_0)$};
            \draw [white] (-1.2,-2) rectangle (5.2,6.2);
        \end{circuitikz}
        }
    \end{column}
    \begin{column}{0.5\textwidth}
        \only<1>
        {\begin{tikzpicture}[scale=1]
            \begin{axis}[%
                width= 0.9\linewidth,
                height= 0.5\linewidth,
                ymin=0, ymax=1.5,
                xmin=0, xmax=4,
                axis lines=center,
                xlabel=$t$,
                ylabel=$v_f$,
                x label style={anchor=west},
                y label style={anchor=south},
                ytick={0.5,1},
                yticklabels={$V_0$,$V$},
                ymax=1.5, % or enlarge y limits=upper
                xticklabels={$t_0$},
                xtick={1},
                ]
            \addplot+[no marks, thick] coordinates {(-1,0.5) (1,0.5) (1,1) (4,1)};
            \end{axis}
        \end{tikzpicture}\\
        Se asume que ha pasado mucho tiempo y por lo tanto el capacitor tiene un voltaje inicial
        \begin{equation*}
            v(t_0) = V_0
        \end{equation*}
        }\only<2-4>
            {\onslide<2->
            {aplicando LCK tenemos que:
            \begin{equation*}
                i_C + i_R = 0
            \end{equation*}
            }\onslide<3->
            {y sabemos que para todo $t>t_0$: 
            \begin{equation*}
                i_C = C\,\dfrac{dv}{dt},\, i_R=\dfrac{v-V}{R}
            \end{equation*}
            }\onslide<4->
            {entonces:
            \begin{equation*}
                C\,\dfrac{dv}{dt} + \dfrac{v-V}{R} = 0
            \end{equation*}
            }
        }\only<5-6>
            {\onslide<5->
            {dividiendo entre $C\,$:
            \begin{equation*}
                \dfrac{dv}{dt} = -\dfrac{v-V}{RC}
            \end{equation*}
            }\onslide<6->
            {reordenado e integrando a ambos lados:
            \begin{equation*}
                \int\limits_{v(t_0)}^{v(t)}\dfrac{1}{v-V}\,dv = \int\limits_{t_0}^{t}-\frac{1}{RC}\,dt
            \end{equation*}
            }
        }\only<7-8>
            {\onslide<7->
            {tenemos que:
            \begin{equation*}
                \ln(v-V)\,\bigg|_{v(t_0)}^{v(t)} = -\frac{1}{RC}t\,\bigg|_{t_0}^{t}
            \end{equation*}
            }\onslide<8->
            {evaluando:
            \begin{equation*}
                \dfrac{\ln(v(t)-V)}{\ln (v(t_0)-V)} = -\frac{1}{RC}(t - t_0)
            \end{equation*}
            }
        }\only<9-10>
            {\onslide<9->
            {aplicamos la función exponencial a ambos lados
            \begin{equation*}
                \dfrac{v(t)-V}{v(t_0)-V} = e\,^{-(t - t_0)/RC}
            \end{equation*}
            }\onslide<10->
            {sea $\tau=RC\,$ y $\,v(t_0) = V_0$, obtenemos:
            \begin{equation*}
                v(t)=V + (V_0-V)e\,^{-(t - t_0)/ \tau}
            \end{equation*}
            }
        }\only<11-13>
            {\onslide<11->
            {\begin{equation*}
                v(t) =
                \begin{cases}
                    V_0, & t < t_0\\
                    V + (V_0-V)e\,^{-(t - t_0)/ \tau}, & t > t_0
                \end{cases}
            \end{equation*}
            }\onslide<12->
            {\begin{equation*}
                i(t) = C\dfrac{dv}{dt} 
            \end{equation*}
            }\onslide<13->
            {\begin{equation*}
                i(t) = 
                \begin{cases}
                    0, & t < t_0\\
                    \dfrac{(V-V_0)}{R}e\,^{-(t - t_0)/ \tau}, & t > t_0
                \end{cases}
            \end{equation*}
            }
        }\only<14-16>
            {\onslide<14->
            {Para $t>t_0$ y reordenando tenemos:\\[2pt]
            \begin{tikzpicture}[scale=1]
                \draw
                (0,0) node[right]{$v(t) = V_0e\,^{-(t - t_0)/ \tau} + V(1-e\,^{-(t - t_0)/ \tau})$}
                ;
                \draw<15-> [decorate,decoration={brace,amplitude=5pt},xshift=0pt,yshift=-7pt]
                (3.3,0) -- (1.3,0) node [black,midway,below,align=center,yshift=-0.1cm] {\footnotesize Respuesta \\ \footnotesize natural}
                ;
                \draw<16-> [decorate,decoration={brace,amplitude=5pt},xshift=0pt,yshift=-7pt]
                (6.7,0) -- (3.8,0) node [black,midway,below,align=center,yshift=-0.1cm] {\footnotesize Respuesta \\ \footnotesize forzada}
                ;
                \draw [white](0,-2) rectangle (7,0.5);
            \end{tikzpicture} 
            }
        }\only<17->
            {\onslide<17->
            {Esta respuesta completa puede expresarse como:\\[2pt]
            \begin{equation*}
                v(t) = v(\infty) + [v(t_0)-v(\infty)]e\,^{-(t - t_0)/ \tau}
            \end{equation*}
            }
        }
    \end{column}
\end{columns}
\end{frame}

\begin{frame}{Ejemplo}
    \begin{columns}[onlytextwidth]
    \begin{column}{0.5\textwidth}
        \centering
        \only<1->{
            \begin{circuitikz}[scale=0.8]
            \draw
            (0,0)
                to [V, l=$v_f$]
            (0,4) 
                to [R, l=\SI{1}{\ohm}]
            (4,4)
                to[C,l=\SI{1}{\farad}, v=$v$,voltage shift=3,i>^=$i$]
            (4,0) 
                to[short]
            (0,0)
            ;
            \node [right] at (-1.1,-1){$v_f(t) = \SI{10}{\volt} [u(t-1) - u(t-3)]$};
            \draw [white] (-1.2,-2) rectangle (5.7,6.2);
        \end{circuitikz}
        }
    \end{column}
    \begin{column}{0.5\textwidth}
        \only<1>
        {Objetivo:\\[4pt]
        Averiguar $v(t)\,$ e $i(t)$  para todo $t$
        }\only<2,5,9>
        {\begin{tikzpicture}[scale=1]
            \begin{axis}[%
                width= 0.9\linewidth,
                height= 0.5\linewidth,
                axis lines=center,
                xlabel=$t$,
                ylabel={$v_f$},
                x label style={anchor=west},
                y label style={anchor=south},
                ytick={1},
                yticklabels={$\SI{10}{\volt}$},
                ymax=1.5, % or enlarge y limits=upper
                xticklabels={$1$,$3$},
                xtick={1,3},
                xmin=-1,
                xmax=4,
                ]
            \addplot+[no marks, thick] coordinates {(-1,0) (1,0) (1,1) (3,1) (3,0) (4,0)};
            \end{axis}
        \end{tikzpicture}
        }\only<3-4>
            {\onslide<3->
            {para $t<1$:
            \begin{equation*}
                v(t)=\SI{0}{\volt}           
            \end{equation*}
            }\onslide<4->
            {por lo tanto
            \begin{equation*}
                v(1)=\SI{0}{\volt}          
            \end{equation*}
            }
        }\only<6-8>
            {\onslide<6->
            {para $1\leq t < 3$:
            \begin{equation*}
                v(t)= v(\infty) + [v(t_0)-v(\infty)]e\,^{-(t - t_0)/ \tau}          
            \end{equation*}
            }\onslide<7->
            {pero $v(\infty) = \SI{10}{\volt}\,$, $\tau=\SI{1}{\second}\,$, $t_0 = \SI{1}{\second}\,$ y $v(1)=\SI{0}{\volt}$, entonces: 
            \begin{equation*}
                v(t)=10\left(1-e\,^{-(t - 1)}\right)         
            \end{equation*}
            }\onslide<8->
            {entonces: 
            \begin{equation*}
                v(3)=10\left(1-e\,^{-2}\right)=\SI{8.647}{\volt}      
            \end{equation*}
            }
        }\only<10-11>
            {\onslide<10->
            {para $t \geq 3$:
            \begin{equation*}
                v(t)= v(\infty) + [v(t_0)-v(\infty)]e\,^{-(t - t_0)/ \tau}          
            \end{equation*}
            }\onslide<11->
            {pero $v(\infty) = \SI{0}{\volt}\,$, $\tau=\SI{1}{\second}\,$, $t_0 = \SI{3}{\second}\,$ y $v(3)=\SI{8.647}{\volt}$, entonces: 
            \begin{equation*}
                v(t)=8.647e\,^{-(t - 3)}        
            \end{equation*}
            }
        }\only<12-13>
            {\onslide<12->
            {Finalmente para todo $t\,$ tenemos que:
            \begin{equation*}
                v(t) =
                \begin{cases}
                    0 &\si{\volt},\quad t < 1\\
                    10\left(1-e\,^{-(t-1)}\right) &\si{\volt},\quad 1 \leq t < 3\\
                    8.647e^{-(t-3)} &\si{\volt},\quad t \geq 3
                \end{cases}
            \end{equation*}
            }
            \onslide<13->
            {\begin{equation*}
                i(t) =
                \begin{cases}
                    0 &\si{\ampere},\quad t < 1\\
                    10e\,^{-(t-1)} &\si{\ampere},\quad 1 < t < 3\\
                    -8.647e^{-(t-3)} &\si{\ampere},\quad t > 3
                \end{cases}
            \end{equation*}
            }
        }\only<14->
        {\begin{tikzpicture}
            \begin{axis}[
                %yshift=-1cm,
                width= \linewidth,
                height= 0.8\linewidth,
                %grid=major, % Display a grid
                %grid style={dashed,gray!30}, % Set the style
                %every axis plot/.append style={thick},
                ymin=-11, ymax=11,
                xmin=-1, xmax=8.5,
                axis x line=bottom,
                axis y line=left,
                axis line style={-},
                %ytick={0,0.368,1},
                % yticklabels={$0$,$\frac{\pi}{2}$,$\pi$,$\frac{3\pi}{2}$},
                %xtick={0,1,2,3,4,5},
                % yticklabels=\empty,
                xlabel={$t[s]$}, % Set the labels
                ylabel=\empty,
                x unit=, 
                y unit=,
                yticklabel style={/pgf/number format/precision=3},
                legend pos=north east,
                %legend style={cells={anchor=west}}
                %legend style={at={(1,0.7)},anchor=west}, % Put the legend below the plot
                %smooth,
                ]
                \addplot [mark=none, color=blue, thick]       
                table[x=t,y=vc,col sep=comma] {progras/RLC/resp_comp_RC.csv};\addlegendentry{$v[\si{\volt}]$}
                \addplot [mark=none, color=red, thick]       
                table[x=t,y=ic,col sep=comma] {progras/RLC/resp_comp_RC.csv};\addlegendentry{$i[\si{\ampere}]$}
                \addplot [mark=none, color=black, dashed]       
                table[x=t,y=vf,col sep=comma] {progras/RLC/resp_comp_RC.csv};\addlegendentry{$v_f[\si{\volt}]$}
            \end{axis}
        \end{tikzpicture}
        }
    \end{column}
\end{columns}
\end{frame}

% \begin{frame}{Referencias}

% \bibliographystyle{ieeetr}

% \bibliography{referencias}

% \end{frame}

\end{document}