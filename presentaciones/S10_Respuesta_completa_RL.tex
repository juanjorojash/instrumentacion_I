\documentclass[aspectratio=169]{beamer}
\usetheme{Bruno}
\input{preamble}
\title{Electricidad I: \\ \emph{Respuestas completa: RL}}
\author{
    Juan J. Rojas
}
\institute{Instituto Tecnológico de Costa Rica}
\date{\today}
\background{fig/background.jpg}
\begin{document}
\input{postamble}
\maketitle

\begin{frame}{Circuito RL: respuesta a un escalón}
    \begin{columns}[onlytextwidth]
    \begin{column}{0.5\textwidth}
        \centering
        \only<1->{
            \begin{circuitikz}[scale=0.8]
            \draw
            (0,0)
                to [I, l=$i_f$]
            (0,4)
                to [short]
            (2,4)
                to [R, l=$R$]
            (2,0)
            (2,4)
                to [short]
            (4,4)
                to[L,l=$L$,i>^=$i$]
            (4,0) 
                to[short]
            (0,0)
            ;
            \draw<2-4> 
                (2,4)
                    to[open,v>=$v_R$,voltage shift=1]
                (2,0)
                (4,4)
                    to[open,v=$v_L$,voltage shift=1]
                (4,0)
            ;
            \node [right] at (-1,-1) {$i_f(t)=I_0u(t_0-t)+Iu(t-t_0)$};
            \draw [white] (-1.3,-2) rectangle (5.3,6.2);
        \end{circuitikz}
        }
    \end{column}
    \begin{column}{0.5\textwidth}
        \only<1>
        {\begin{tikzpicture}[scale=1]
            \begin{axis}[%
                width= 0.9\linewidth,
                height= 0.5\linewidth,
                ymin=0, ymax=1.5,
                xmin=0, xmax=4,
                axis lines=center,
                xlabel=$t$,
                ylabel=$i_f$,
                x label style={anchor=west},
                y label style={anchor=south},
                ytick={0.5,1},
                yticklabels={$I_0$,$I$},
                ymax=1.5, % or enlarge y limits=upper
                xticklabels={$t_0$},
                xtick={1},
                ]
            \addplot+[no marks, thick] coordinates {(-1,0.5) (1,0.5) (1,1) (4,1)};
            \end{axis}
        \end{tikzpicture}\\
        Se asume que ha pasado mucho tiempo y por lo tanto el inductor tiene una corriente inicial
        \begin{equation*}
            i(t_0) = I_0
        \end{equation*}
        }\only<2-4>
            {\onslide<2->
            {aplicando LVK tenemos que:
            \begin{equation*}
                v_L + v_R = 0
            \end{equation*}
            }\onslide<3->
            {y sabemos que para todo $t>t_0$: 
            \begin{equation*}
                v_L = L\,\dfrac{di}{dt},\, v_R=(i-I)R
            \end{equation*}
            }\onslide<4->
            {entonces:
            \begin{equation*}
                L\,\dfrac{di}{dt} + (i-I)R = 0
            \end{equation*}
            }
        }\only<5-6>
            {\onslide<5->
            {dividiendo entre $L\,$:
            \begin{equation*}
                \dfrac{di}{dt} = -\dfrac{(i-I)R}{L}
            \end{equation*}
            }\onslide<6->{
            reordenando e integrando a ambos lados:
            \begin{equation*}
                \int\limits_{i(t_0)}^{i(t)}\dfrac{1}{i-I}\,di = \int\limits_{t_0}^{t}-\frac{R}{L}\,dt
            \end{equation*}
            }
        }\only<7-8>
            {\onslide<7->
            {tenemos que:
            \begin{equation*}
                \ln(i-I)\,\bigg|_{i(t_0)}^{i(t)} = -\frac{R}{L}t\,\bigg|_{t_0}^{t}
            \end{equation*}
            }\onslide<8->
            {evaluando:
            \begin{equation*}
                \dfrac{\ln(i(t)-I)}{\ln (i(t_0)-I)} = -\frac{R}{L}(t - t_0)
            \end{equation*}
            }
        }\only<9-10>
            {\onslide<9->
            {aplicamos la función exponencial a ambos lados
            \begin{equation*}
                \dfrac{i(t)-I}{i(t_0)-I} = e\,^{-(t - t_0)R/L}
            \end{equation*}
            }\onslide<10->
            {sea $\tau=L/R\,$ y $\,i(t_0) = I_0$, obtenemos:
            \begin{equation*}
                i(t)=I + (I_0-I)e\,^{-(t - t_0)/ \tau}
            \end{equation*}
            }
        }\only<11-13>
            {\onslide<11->
            {\begin{equation*}
                i(t) =
                \begin{cases}
                    I_0, & t < t_0\\
                    I + (I_0-I)e\,^{-(t - t_0)/ \tau}, & t \geq t_0
                \end{cases}
            \end{equation*}
            }\onslide<12->
            {\begin{equation*}
                v(t) = L\dfrac{di}{dt} 
            \end{equation*}
            }\onslide<13->
            {\begin{equation*}
                v(t) = 
                \begin{cases}
                    0, & t < t_0\\
                    (I-I_0)R e\,^{-(t - t_0)/ \tau}, & t > t_0
                \end{cases}
            \end{equation*}
            }
        }\only<14-16>
            {\onslide<14->
            {Para $t>t_0$ y reordenando tenemos:\\[4pt]
            \begin{tikzpicture}[scale=1]
                \draw
                (0,0) node[right]{$i(t) = I_0e\,^{-(t - t_0)/ \tau} + I(1-e\,^{-(t - t_0)/ \tau})$}
                ;
                \draw<15-> [decorate,decoration={brace,amplitude=5pt},xshift=0pt,yshift=-7pt]
                (3.2,0) -- (1.2,0) node [black,midway,below,align=center,yshift=-0.1cm] {\footnotesize Respuesta \\ \footnotesize natural}
                ;
                \draw<16-> [decorate,decoration={brace,amplitude=5pt},xshift=0pt,yshift=-7pt]
                (6.4,0) -- (3.5,0) node [black,midway,below,align=center,yshift=-0.1cm] {\footnotesize Respuesta \\ \footnotesize forzada}
                ;
                \draw [white](0,-2) rectangle (7,0.5);
            \end{tikzpicture} 
            }
        }\only<17->
            {\onslide<17->
            {Esta respuesta completa puede expresarse como:\\[2pt]
            \begin{equation*}
                i(t) = i(\infty) + [i(t_0)-i(\infty)]e\,^{-(t - t_0)/ \tau}
            \end{equation*}
            }
        }
    \end{column}
\end{columns}
\end{frame}

\begin{frame}{Ejemplo}
    \begin{columns}[onlytextwidth]
    \begin{column}{0.5\textwidth}
        \centering
        \only<1->{
            \begin{circuitikz}[scale=0.8]
            \draw
            (0,0)
                to [I, l=$i_f$]
            (0,4)
                to [short]
            (2,4)
                to [R, l=\SI{1}{\ohm}]
            (2,0)
            (2,4)
                to [short]
            (4,4)
                to[L,l=\SI{1}{\henry},i>^=$i$,v=$v$]
            (4,0) 
                to[short]
            (0,0)
            ;
            \node [right] at (-1.7,-1) {$i_f(t)= \SI{5}{\ampere} [1 + u(t-1) - u(t-4)]$};
            \draw [white] (-1.7,-2) rectangle (5.7,6.2);
        \end{circuitikz}
        }
    \end{column}
    \begin{column}{0.5\textwidth}
        \only<1>
        {Objetivo:\\[4pt]
        Averiguar $i(t)\,$ y $v(t)$  para todo $t$
        }\only<2,5,9>
        {\begin{tikzpicture}[scale=1]
            \begin{axis}[%
                width= 0.9\linewidth,
                height= 0.5\linewidth,
                xmin=-1, xmax=5,
                ymin=0, ymax = 1.5,
                axis lines=center,
                xlabel=$t$,
                ylabel=$i_f$,
                x label style={anchor=west},
                y label style={anchor=south},
                ytick={1},
                yticklabels={$\SI{10}{\ampere}$},
                ymax=1.5, % or enlarge y limits=upper
                xticklabels={$1$,$4$},
                xtick={1,4}
                ]
            \addplot+[no marks, thick] coordinates {(-1,0.5) (1,0.5) (1,1) (4,1) (4,0.5) (5,0.5)};
            \end{axis}
        \end{tikzpicture}
        }\only<3-4>
            {\onslide<3->
            {para $t<1$:
            \begin{equation*}
                i(t)=\SI{5}{\ampere}          
            \end{equation*}
            }\onslide<4->
            {por lo tanto
            \begin{equation*}
                i(1)=\SI{5}{\ampere}           
            \end{equation*}
            }
        }\only<6-8>
            {\onslide<6->
            {para $1\leq t < 4$:
            \begin{equation*}
                i(t)= i(\infty) + [i(t_0)-i(\infty)]e\,^{-(t - t_0)/ \tau}          
            \end{equation*}
            }\onslide<7->
            {pero $i(\infty) = \SI{10}{\ampere}\,$, $\tau=\SI{1}{\second}\,$, $t_0 = \SI{1}{\second}\,$ y $i(1)=\SI{5}{\ampere}$, entonces: 
            \begin{equation*}
                i(t)=10\left(1-0.5e\,^{-(t - 1)}\right)         
            \end{equation*}
            }\onslide<8->
            {entonces: 
            \begin{equation*}
                i(4)=10\left(1-0.5e\,^{-3}\right)=\SI{9.751}{\ampere}      
            \end{equation*}
            }
        }\only<10-11>
            {\onslide<10->
            {para $t \geq 4$:
            \begin{equation*}
                i(t)= i(\infty) + [i(t_0)-i(\infty)]e\,^{-(t - t_0)/ \tau}          
            \end{equation*}
            }\onslide<11->
            {pero $i(\infty) = \SI{5}{\ampere}\,$, $\tau=\SI{1}{\second}\,$, $t_0 = \SI{4}{\second}\,$ y $i(4)=\SI{9.751}{\ampere}$, entonces: 
            \begin{equation*}
                i(t)=5+4.751e\,^{-(t - 4)}        
            \end{equation*}
            }
        }\only<12-13>
            {\onslide<12->
            {Finalmente para todo $t\,$ tenemos que:
            \begin{equation*}
                i(t) =
                \begin{cases}
                    5 &\si{\ampere},\quad t < 1\\
                    10\left(1-0.5e\,^{-(t-1)}\right) &\si{\ampere},\quad 1 \leq t < 4\\
                    5+4.751e^{-(t-4)} &\si{\ampere},\quad t \geq 4
                \end{cases}
            \end{equation*}
            }
            \onslide<13->
            {\begin{equation*}
                v(t) =
                \begin{cases}
                    0 &\si{\volt},\quad t < 1\\
                    5e\,^{-(t-1)} &\si{\volt},\quad 1 < t < 4\\
                    -4.751e^{-(t-4)} &\si{\volt},\quad t > 4
                \end{cases}
            \end{equation*}
            }
        }\only<14->
        {\begin{tikzpicture}
            \begin{axis}[
                %yshift=-1cm,
                width= \linewidth,
                height= 0.8\linewidth,
                %grid=major, % Display a grid
                %grid style={dashed,gray!30}, % Set the style
                %every axis plot/.append style={thick},
                ymin=-11, ymax=11,
                xmin=-1, xmax=8,
                axis x line=bottom,
                axis y line=left,
                axis line style={-},
                %ytick={0,0.368,1},
                % yticklabels={$0$,$\frac{\pi}{2}$,$\pi$,$\frac{3\pi}{2}$},
                %xtick={0,1,2,3,4,5},
                % yticklabels=\empty,
                xlabel={$t[s]$}, % Set the labels
                ylabel=\empty,
                x unit=, 
                y unit=,
                yticklabel style={/pgf/number format/precision=3},
                legend pos=south west,
                %legend style={cells={anchor=west}}
                %legend style={at={(1,0.7)},anchor=west}, % Put the legend below the plot
                %smooth,
                ]
                \addplot [mark=none, color=blue, thick]       
                table[x=t,y=il,col sep=comma] {progras/RLC/resp_comp_RL.csv};\addlegendentry{$i[\si{\ampere}]$}
                \addplot [mark=none, color=red, thick]       
                table[x=t,y=vl,col sep=comma] {progras/RLC/resp_comp_RL.csv};\addlegendentry{$v[\si{\volt}]$}
                \addplot [mark=none, color=black, dashed]       
                table[x=t,y=if,col sep=comma] {progras/RLC/resp_comp_RL.csv};\addlegendentry{$i_f[\si{\ampere}]$}
            \end{axis}
        \end{tikzpicture}
        }
    \end{column}
\end{columns}
\end{frame}

% \begin{frame}{Referencias}

% \bibliographystyle{ieeetr}

% \bibliography{referencias}

% \end{frame}

\end{document}